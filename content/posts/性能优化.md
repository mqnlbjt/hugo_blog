---
title: "性能优化-1"
date: 2025-08-04T14:38:32+08:00
draft: false
tags: [java，压力测试]
---



# 性能优化-1

`3s定律`：Strangeloop在对众多的网站做性能分析之后得出了一个著名的3s定律“页面加载速度超过3s，57%的访客会离开”。

响应时间影响seo排名。

+ 前端：
  + 首屏时间 ——dns 网络传输 接口响应 浏览器渲染
  + 白屏时间
  + 可交互时间
  + 完全加载时间
+ 后端：
  + rt
  + tps
  + 并发数

影响后端性能的因素：

+ 数据库读写 rpc 网络io 
+ jvm 逻辑复杂度 缓存

>  产品设计 + 基础网络 + 代码质量 + 架构 + 移动端环境 + 硬件与云服务 ---->性能   

### 压力测试

对系统不断施加压力评估系统负载能力。 

系统测试需要注意几个指标：响应时间RT，吞吐量(吞吐量是指系统在单位时间内处理请求的数量tps和qps都是吞吐量的一种 )，并发用户数，错误率，资源利用率(cpu占用，内存使用率，系统负载，网络io)。

+ 最优并发用户数：吞吐量达到最高，响应时间保持稳定。
  + 如果并发用户数超过这个值，系统的吞吐量和响应时间会开始出现“此消彼长”的现象——即响应时间延长，而吞吐量增长放缓或停止增长。
+ 最大并发用户数：系统在崩溃前能够承受的极限并发用户数量。
  + 响应时间急剧增长，吞吐量开始呈现下降趋势。
  + 系统开始出现大量请求错误。
  + 当负载超过最大并发用户数后，系统将处于“崩溃区”（Buckle Zone），响应时间变得极长，错误率飙升，最终导致用户放弃请求

#### 线程组配置

使用线程组来模拟一组用户访问系统资源(可以使用分布式jmeter来模拟更重的负载)，循环次数表示了循环执行多少次操作，循环次数直接决定整个测试单个线程的执行时间，和整体测试执行时间。Ramp-Up Period ，要在多长时间内建立全部的线程。

>  如果需要更详细的压测报告需要使用jmeter的插件,需要下载plugins-manager.jar将其放入lib目录下。

### 各指标详解

1. RT：响应时间，有平均值，中位数，p90(百分之90的请求的响应时间)，p99，p95。
2. 压力机的活动线程数。
3. tps；每秒的事务数。
4. qps；每秒的查询数。
5. 吞吐量：每秒请求次数 >= qps和tps。

服务器端使用 `top -H`可以看到一个系统负载load average，一般分为：1分钟平均负载，5分钟平均负载，15分钟平均负载

+ 系统负载衡量有多少进程等待cpu调度，计算机系统执行的计算工作量的指标。
+ 平均负载（Load Average）是一段时间内系统的平均负载。
+ 对于不同核心数的cpu的负载标准是不一样的。
  + 对于单核cpu来说 load > 0.7已经算是繁忙了。
  + 对于双核cpu来说 load > 1 也只代表使用满了一颗cpu的资源。 

> 对不同load值的分析：
>
> 1. 1分钟负载 > 5，5分钟负载 < 1，15分钟负载 < 1
>    + 短期内繁忙，中长期空闲，可能是堵塞的前兆。
> 2. 1分钟负载 > 5，5分钟负载 > 1，15分钟负载 < 1
>    + 短期内繁忙，中期内紧张，可能刚开始拥塞。
> 3. 1分钟负载 < 1，5分钟负载 > 1，15分钟负载 > 5
>    + 拥塞正在好转。
